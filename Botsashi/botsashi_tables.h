#ifndef BOTSASHI_TABLES
#define BOTSASHI_TABLES

#include <array>
#include <functional>
#include <iostream>
#include <unordered_map>
#include "botsashi.h"
#include "botsashi_precise.h"
using namespace std;
using namespace botsashi;

namespace botsashi
{

  void unrecognizedinst(Botsashi* m68k)
  {
    cout << "Unrecognized opcode at " << hex << (int)(m68k->currentinstr) << endl;
    exit(1);
  }

  using m68kfunc = function<void(Botsashi*)>;

  array<uint16_t, 81> resulttable =
  {
	  0x0000, 0x01C0, 0x4800, 0x4E73, 0x6000, 0xC0C0, 
	  0x0200, 0x0108, 0x4840, 0x4E75, 0x7000, 0xC1C0, 
	  0x0400, 0x1000, 0x4840, 0x4E76, 0x80C0, 0xC100, 
	  0x0600, 0x2000, 0x4AFC, 0x4E77, 0x81C0, 0xC130, 
	  0x0A00, 0x3000, 0x4AC0, 0x4E80, 0x8100, 0xC000, 
  	0x0C00, 0x40C0, 0x4A00, 0x4EC0, 0x8000, 0xD100, 
	  0x0000, 0x44C0, 0x4E40, 0x4880, 0x9100, 0xD0C0, 
	  0x0040, 0x46C0, 0x4E50, 0x41C0, 0x90C0, 0xD000, 
	  0x0080, 0x4000, 0x4E58, 0x4180, 0x9000, 0xE0C0, 
	  0x00C0, 0x4200, 0x4E60, 0x5000, 0xB100, 0xE2C0, 
	  0x0100, 0x4400, 0x4E70, 0x5100, 0xB108, 0xE4C0, 
	  0x0140, 0x4600, 0x4E71, 0x50C0, 0xB000, 0xE6C0, 
	  0x0180, 0x4880, 0x4E72, 0x50C8, 0xB0C0, 0xE000, 
	  0xE008, 0xE010, 0xE018, 
  };

  array<uint16_t, 81> masktable =
  {
	  0xFF00, 0xF1C0, 0xFFC0, 0xFFFF, 0xF000, 0xF1C0, 
	  0xFF00, 0xF108, 0xFFF8, 0xFFFF, 0xF000, 0xF1C0, 
	  0xFF00, 0xF000, 0xFFC0, 0xFFFF, 0xF1C0, 0xF1F0, 
	  0xFF00, 0xF000, 0xFFFF, 0xFFFF, 0xF1C0, 0xF130, 
	  0xFF00, 0xF000, 0xFFC0, 0xFFC0, 0xF1F0, 0xF000, 
	  0xFF00, 0xFFC0, 0xFFF0, 0xFFC0, 0xF000, 0xF130, 
	  0xF1C0, 0xFFC0, 0xFFF0, 0xFB80, 0xF130, 0xF0C0, 
	  0xF1C0, 0xFFC0, 0xFFF8, 0xF1C0, 0xF0C0, 0xF000, 
	  0xF1C0, 0xFF00, 0xFFF8, 0xF1C0, 0xF000, 0xFEC0, 
	  0xF1C0, 0xFF00, 0xFFF0, 0xF100, 0xF100, 0xFEC0, 
	  0xF1C0, 0xFF00, 0xFFFF, 0xF100, 0xF138, 0xFEC0, 
	  0xF1C0, 0xFF00, 0xFFFF, 0xF0C0, 0xF100, 0xFEC0, 
  	0xF1C0, 0xFFB8, 0xFFFF, 0xF0C8, 0xF0C0, 0xF018, 
	  0xF018, 0xF018, 0xF018, 
  };

  unordered_map<uint16_t, m68kfunc> functable =
  {
	  { 0x0000, unrecognizedinst },
	  { 0x0200, unrecognizedinst },
	  { 0x0400, unrecognizedinst },
	  { 0x0600, unrecognizedinst },
	  { 0x0A00, unrecognizedinst },
	  { 0x0C00, unrecognizedinst },
	  { 0x0000, unrecognizedinst },
	  { 0x0040, unrecognizedinst },
	  { 0x0080, unrecognizedinst },
	  { 0x00C0, unrecognizedinst },
	  { 0x0100, unrecognizedinst },
	  { 0x0140, unrecognizedinst },
	  { 0x0180, unrecognizedinst },
	  { 0x01C0, unrecognizedinst },
	  { 0x0108, unrecognizedinst },
	  { 0x1000, m68kmovb },
	  { 0x2000, m68kmovl },
	  { 0x3000, m68kmovw },
	  { 0x40C0, unrecognizedinst },
	  { 0x44C0, unrecognizedinst },
	  { 0x46C0, unrecognizedinst },
	  { 0x4000, unrecognizedinst },
	  { 0x4200, unrecognizedinst },
	  { 0x4400, unrecognizedinst },
  	{ 0x4600, unrecognizedinst },
	  { 0x4880, unrecognizedinst },
	  { 0x4800, unrecognizedinst },
	  { 0x4840, unrecognizedinst },
	  { 0x4840, unrecognizedinst },
	  { 0x4AFC, unrecognizedinst },
	  { 0x4AC0, unrecognizedinst },
	  { 0x4A00, unrecognizedinst },
	  { 0x4E40, m68ktrap },
  	{ 0x4E50, unrecognizedinst },
	  { 0x4E58, unrecognizedinst },
	  { 0x4E60, unrecognizedinst },
  	{ 0x4E70, unrecognizedinst },
  	{ 0x4E71, unrecognizedinst },
	  { 0x4E72, m68kstop },
	  { 0x4E73, unrecognizedinst },
	  { 0x4E75, unrecognizedinst },
  	{ 0x4E76, unrecognizedinst },
	  { 0x4E77, unrecognizedinst },
  	{ 0x4E80, unrecognizedinst },
	  { 0x4EC0, unrecognizedinst },
	  { 0x4880, unrecognizedinst },
	  { 0x41C0, m68klea },
	  { 0x4180, unrecognizedinst },
  	{ 0x5000, unrecognizedinst },
	  { 0x5100, unrecognizedinst },
	  { 0x50C0, unrecognizedinst },
	  { 0x50C8, unrecognizedinst },
	  { 0x6000, m68kbranch },
	  { 0x7000, unrecognizedinst },
	  { 0x80C0, unrecognizedinst },
	  { 0x81C0, unrecognizedinst },
	  { 0x8100, unrecognizedinst },
	  { 0x8000, unrecognizedinst },
	  { 0x9100, unrecognizedinst },
	  { 0x90C0, unrecognizedinst },
	  { 0x9000, unrecognizedinst },
	  { 0xB100, unrecognizedinst },
  	{ 0xB108, unrecognizedinst },
  	{ 0xB000, unrecognizedinst },
	  { 0xB0C0, unrecognizedinst },
	  { 0xC0C0, unrecognizedinst },
	  { 0xC1C0, unrecognizedinst },
	  { 0xC100, unrecognizedinst },
	  { 0xC130, unrecognizedinst },
	  { 0xC000, unrecognizedinst },
	  { 0xD100, unrecognizedinst },
  	{ 0xD0C0, unrecognizedinst },
	  { 0xD000, unrecognizedinst },
	  { 0xE0C0, unrecognizedinst },
	  { 0xE2C0, unrecognizedinst },
	  { 0xE4C0, unrecognizedinst },
	  { 0xE6C0, unrecognizedinst },
	  { 0xE000, unrecognizedinst },
	  { 0xE008, unrecognizedinst },
	  { 0xE010, unrecognizedinst },
	  { 0xE018, unrecognizedinst },
  };
}

#endif // BOTSASHI_TABLES
